<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>AVR32 - FAT Services: Use automatic navigation</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Use automatic navigation<br>
<small>
[<a class="el" href="a00057.html">Examples</a>]</small>
</h1>If you want to play all files (*.mp3 and *.mp2) available in all disks or one disk : <div class="fragment"><pre class="fragment">use_explorer()
{
   <a class="code" href="a00016.html" title="Structure to store the status from function navauto_mov().">Navauto_mov_state</a> status_mov;
   _MEM_TYPE_SLOW_   U8    ext_filemusic[]    = <span class="stringliteral">"mp3,mp2"</span>;
   
   <span class="comment">// Init explorer mode</span>
   <a class="code" href="a00039.html#226299cc74eecb96d9af16077b8e769f" title="This function initializes the file extension filter used to create the file list...">navauto_init</a>( ext_filemusic );         <span class="comment">// Init filter to use </span>
   <a class="code" href="a00039.html#cac0f26a59241dec8b77d05353091b9c" title="This function sets the directory limitation of the file list.">navauto_setmode</a>( <a class="code" href="a00040.html#626a49dbaec5b2a92495ed3953b3b60e">NAVAUTO_MODE_DISK</a> );  <span class="comment">// Scan only the current disk (sub folder include)</span>
   <a class="code" href="a00039.html#b199f759f8a128b99c5efaeeddc7699e" title="This function changes the random state.">navauto_setrand</a>( <a class="code" href="a00040.html#c54b93ddb02003b0e4a90eb1133f9204">NAVAUTO_RAND_OFF</a> );   <span class="comment">// Init random mode</span>

   <a class="code" href="a00047.html#7fac26539a62daf547b5eb159f6a43d4" title="This function selects the navigation to use.">nav_select</a>(0);                         <span class="comment">// Choose a free navigator</span>
   
   <span class="comment">// Select your disk</span>
   <a class="code" href="a00047.html#dd247ba4e5086c74c6f106a55617872a" title="This function selects a drive in navigator but don&amp;#39;t mount the disk partition...">nav_drive_set</a>(1);
   <a class="code" href="a00047.html#aa10a2b4e4db0e4eb602b19b4f9ff9b9" title="This function mounts the selected partition.">nav_partition_mount</a>();
      
   <span class="comment">// Open automatic navigation</span>
   <span class="comment">// This one take the current position to init the file list</span>
   <span class="keywordflow">if</span>( !<a class="code" href="a00039.html#6d888c44ab0f614f283b09def5de12dd" title="This function opens a file list at the current position in navigator.">navauto_open</a>( FALSE, 0 ))             <span class="comment">// Here, the folder level param is ignored because the mode disk is selected</span>
      <span class="keywordflow">return</span> FALSE;

   <span class="comment">// NOW EXPLORER</span>
   <span class="keywordflow">do</span>
   {
      <span class="comment">// HERE a file is selected</span>
      <span class="comment">// You can play file or display file or ...</span>
   
      <span class="comment">// Play file finish then go to next</span>
      status_mov = <a class="code" href="a00039.html#3d9a71a0da2374bdfa6ca1370220eb0e" title="This function jumps to the next or previous file in file list.">navauto_mov</a>( <a class="code" href="a00048.html#793c4ce9436637d68ab25dc859abc35a" title="move in list to next file">FS_FIND_NEXT</a> );      
      <span class="keywordflow">if</span>( <a class="code" href="a00040.html#b8dacdd6e521af20cfc02bdb25eadedb">NAVAUTO_MOV_OK_LOOP</a>  == status_mov )
      {
         <span class="keywordflow">if</span>( FALSE == repeat_mode )
            <span class="keywordflow">break</span>; <span class="comment">// Exit loop</span>
      }
   }<span class="keywordflow">while</span>(  (<a class="code" href="a00040.html#633fe72598151184ddb0aeaab5003173">NAVAUTO_MOV_OK</a>       == status_mov )
   ||       (<a class="code" href="a00040.html#b8dacdd6e521af20cfc02bdb25eadedb">NAVAUTO_MOV_OK_LOOP</a>  == status_mov ) );

   <span class="keywordflow">switch</span>( status_mov )
   {
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#b8dacdd6e521af20cfc02bdb25eadedb">NAVAUTO_MOV_OK_LOOP</a>:         <span class="comment">// End of loop</span>
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#65e04d2db1abc237d8e7bdd481ed9606">NAVAUTO_MOV_EMPTY</a>:           <span class="comment">// loop empty</span>
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#04d5fe8182d1394f6d64c3225fbc5a39">NAVAUTO_MOV_DISKNOPRESENT</a>:   <span class="comment">// All disks or a disk is not present (depends of NAVAUTO_MODE)</span>
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#f59298fde754b54c1c443a67ac6a79fc">NAVAUTO_MOV_DISKERROR</a>:       <span class="comment">// Access error on all or one disk (depends of NAVAUTO_MODE)</span>
   }
   <a class="code" href="a00039.html#0a611e9ea74f3f53cd26e6db4460dbb5" title="This function closes the file list.">navauto_close</a>();
}
</pre></div><p>
If you want to play all files (*.mp3 and *.mp2) available in a first dir (and subdir) : <div class="fragment"><pre class="fragment">use_explorer()
{
   <a class="code" href="a00016.html" title="Structure to store the status from function navauto_mov().">Navauto_mov_state</a> status_mov;
   _MEM_TYPE_SLOW_   U8    ext_filemusic[]    = <span class="stringliteral">"mp3,mp2"</span>;
   
   <span class="comment">// Init explorer mode</span>
   <a class="code" href="a00039.html#226299cc74eecb96d9af16077b8e769f" title="This function initializes the file extension filter used to create the file list...">navauto_init</a>( ext_filemusic );         <span class="comment">// Init filter to use </span>
   <a class="code" href="a00039.html#cac0f26a59241dec8b77d05353091b9c" title="This function sets the directory limitation of the file list.">navauto_setmode</a>( <a class="code" href="a00040.html#663d1ffece363baf091ccf3acde56b7a">NAVAUTO_MODE_DIRSUB</a> );<span class="comment">// Scan folder and sub folder</span>
   <a class="code" href="a00039.html#b199f759f8a128b99c5efaeeddc7699e" title="This function changes the random state.">navauto_setrand</a>( <a class="code" href="a00040.html#c54b93ddb02003b0e4a90eb1133f9204">NAVAUTO_RAND_OFF</a> );   <span class="comment">// Init random mode</span>

   <a class="code" href="a00047.html#7fac26539a62daf547b5eb159f6a43d4" title="This function selects the navigation to use.">nav_select</a>(0);                         <span class="comment">// Choose a free navigator</span>
   
   <span class="comment">// Enter in first dir of a disk</span>
   <a class="code" href="a00047.html#dd247ba4e5086c74c6f106a55617872a" title="This function selects a drive in navigator but don&amp;#39;t mount the disk partition...">nav_drive_set</a>(1);
   <a class="code" href="a00047.html#aa10a2b4e4db0e4eb602b19b4f9ff9b9" title="This function mounts the selected partition.">nav_partition_mount</a>();
   <a class="code" href="a00047.html#6f711a14b01a8796caf8d6117d61ab09" title="This function goes to at the first file or directory in file list.">nav_filelist_first</a>( <a class="code" href="a00031.html#d043d9359eeca08e8c5ea4d9136eb15b">FS_DIR</a> );
   <a class="code" href="a00047.html#dca006b356e65cb05459f7bd7917a1ed" title="This function enters in the selected directory in file list.">nav_dir_cd</a>();
   
   <span class="comment">// Explore current dir and sub dir</span>
   <span class="keywordflow">if</span>( !<a class="code" href="a00039.html#6d888c44ab0f614f283b09def5de12dd" title="This function opens a file list at the current position in navigator.">navauto_open</a>( FALSE , 0 ))        <span class="comment">// The param folder level is 0 because the current folder is the base of navigation</span>
      <span class="keywordflow">return</span> FALSE;

   <span class="comment">// NOW EXPLORER</span>
   <span class="keywordflow">do</span>
   {
      <span class="comment">// HERE a file is selected</span>
      <span class="comment">// You can play file or display file or ...</span>
   
      <span class="comment">// Play file finish then go to next</span>
      status_mov = <a class="code" href="a00039.html#3d9a71a0da2374bdfa6ca1370220eb0e" title="This function jumps to the next or previous file in file list.">navauto_mov</a>( <a class="code" href="a00048.html#793c4ce9436637d68ab25dc859abc35a" title="move in list to next file">FS_FIND_NEXT</a> );      
      <span class="keywordflow">if</span>( <a class="code" href="a00040.html#b8dacdd6e521af20cfc02bdb25eadedb">NAVAUTO_MOV_OK_LOOP</a>  == status_mov )
      {
         <span class="keywordflow">if</span>( FALSE == repeat_mode )
            <span class="keywordflow">break</span>; <span class="comment">// Exit loop</span>
      }
   }<span class="keywordflow">while</span>(  (<a class="code" href="a00040.html#633fe72598151184ddb0aeaab5003173">NAVAUTO_MOV_OK</a>       == status_mov )
   ||       (<a class="code" href="a00040.html#b8dacdd6e521af20cfc02bdb25eadedb">NAVAUTO_MOV_OK_LOOP</a>  == status_mov ) );

   <span class="keywordflow">switch</span>( status_mov )
   {
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#b8dacdd6e521af20cfc02bdb25eadedb">NAVAUTO_MOV_OK_LOOP</a>:         <span class="comment">// End of loop</span>
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#65e04d2db1abc237d8e7bdd481ed9606">NAVAUTO_MOV_EMPTY</a>:           <span class="comment">// loop empty</span>
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#04d5fe8182d1394f6d64c3225fbc5a39">NAVAUTO_MOV_DISKNOPRESENT</a>:   <span class="comment">// All disks or a disk is not present (depends of NAVAUTO_MODE)</span>
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#f59298fde754b54c1c443a67ac6a79fc">NAVAUTO_MOV_DISKERROR</a>:       <span class="comment">// Access error on all or one disk (depends of NAVAUTO_MODE)</span>
   }
   <a class="code" href="a00039.html#0a611e9ea74f3f53cd26e6db4460dbb5" title="This function closes the file list.">navauto_close</a>();
}
</pre></div><p>
If you want to play all files available in a playlist : <div class="fragment"><pre class="fragment">use_explorer()
{
   <a class="code" href="a00016.html" title="Structure to store the status from function navauto_mov().">Navauto_mov_state</a> status_mov;
   <span class="keyword">const</span> _MEM_TYPE_SLOW_ U8 name[]=<span class="stringliteral">"playlist.mu3"</span>;
   
   <span class="comment">// Init explorer mode</span>
   <span class="comment">//navauto_init( ext_filemusic );          // Init filter to use, NO USED in play list</span>
   <span class="comment">//navauto_setmode( NAVAUTO_MODE_DIRSUB ); // Scan folder and sub folder, NO USED in play list</span>
   <a class="code" href="a00039.html#b199f759f8a128b99c5efaeeddc7699e" title="This function changes the random state.">navauto_setrand</a>( <a class="code" href="a00040.html#c54b93ddb02003b0e4a90eb1133f9204">NAVAUTO_RAND_OFF</a> );      <span class="comment">// Init random mode</span>
   
   <a class="code" href="a00047.html#7fac26539a62daf547b5eb159f6a43d4" title="This function selects the navigation to use.">nav_select</a>(0);                            <span class="comment">// Choose a free navigator</span>
   
   <span class="comment">// Select your play list file</span>
   <a class="code" href="a00047.html#dd247ba4e5086c74c6f106a55617872a" title="This function selects a drive in navigator but don&amp;#39;t mount the disk partition...">nav_drive_set</a>(1);
   <a class="code" href="a00047.html#aa10a2b4e4db0e4eb602b19b4f9ff9b9" title="This function mounts the selected partition.">nav_partition_mount</a>();
<span class="preprocessor">#if( (FS_ASCII == ENABLED) &amp;&amp; (FS_UNICODE == ENABLED) )</span>
<span class="preprocessor"></span>   <a class="code" href="a00047.html#7489cf6b312750301cb7df5b915b436a" title="This function selects the ASCII mode for all routines with FS_STRING parameter.">nav_string_ascii</a>();  <span class="comment">// Select a ASCII name format</span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>   <span class="keywordflow">if</span>( !<a class="code" href="a00047.html#017ce6b53af128e5064a06bc8fadec25" title="This function searchs a file name in file list.">nav_filelist_findname</a>( (<a class="code" href="a00031.html#caff53a7315dfcce82e06ae11c771e8c">FS_STRING</a>)name , FALSE ) )   <span class="comment">// search file "playlist.mu3" in root dir</span>
      <span class="keywordflow">return</span> FALSE;
   
   <span class="comment">// Explore all disks available</span>
   <span class="keywordflow">if</span>( !<a class="code" href="a00039.html#6d888c44ab0f614f283b09def5de12dd" title="This function opens a file list at the current position in navigator.">navauto_open</a>( TRUE , 0 ))            <span class="comment">// param O to select the first file of the play list</span>
      <span class="keywordflow">return</span> FALSE;

   <span class="comment">// NOW EXPLORER</span>
   <span class="keywordflow">do</span>
   {
      <span class="comment">// HERE a file is selected</span>
      <span class="comment">// You can play file or display file or ...</span>
   
      <span class="comment">// Play file finish then go to next</span>
      status_mov = <a class="code" href="a00039.html#3d9a71a0da2374bdfa6ca1370220eb0e" title="This function jumps to the next or previous file in file list.">navauto_mov</a>( <a class="code" href="a00048.html#793c4ce9436637d68ab25dc859abc35a" title="move in list to next file">FS_FIND_NEXT</a> );      
      <span class="keywordflow">if</span>( <a class="code" href="a00040.html#b8dacdd6e521af20cfc02bdb25eadedb">NAVAUTO_MOV_OK_LOOP</a>  == status_mov )
      {
         <span class="keywordflow">if</span>( FALSE == repeat_mode )
            <span class="keywordflow">break</span>; <span class="comment">// Exit loop</span>
      }
   }<span class="keywordflow">while</span>(  (<a class="code" href="a00040.html#633fe72598151184ddb0aeaab5003173">NAVAUTO_MOV_OK</a>       == status_mov )
   ||       (<a class="code" href="a00040.html#b8dacdd6e521af20cfc02bdb25eadedb">NAVAUTO_MOV_OK_LOOP</a>  == status_mov ) );

   <span class="keywordflow">switch</span>( status_mov )
   {
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#b8dacdd6e521af20cfc02bdb25eadedb">NAVAUTO_MOV_OK_LOOP</a>:         <span class="comment">// End of loop</span>
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#65e04d2db1abc237d8e7bdd481ed9606">NAVAUTO_MOV_EMPTY</a>:           <span class="comment">// loop empty</span>
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#04d5fe8182d1394f6d64c3225fbc5a39">NAVAUTO_MOV_DISKNOPRESENT</a>:   <span class="comment">// All disks or a disk is not present (depends of NAVAUTO_MODE)</span>
      <span class="keywordflow">case</span> <a class="code" href="a00040.html#f59298fde754b54c1c443a67ac6a79fc">NAVAUTO_MOV_DISKERROR</a>:       <span class="comment">// Access error on all or one disk (depends of NAVAUTO_MODE)</span>
   }
   <a class="code" href="a00039.html#0a611e9ea74f3f53cd26e6db4460dbb5" title="This function closes the file list.">navauto_close</a>();
}
</pre></div><p>
If you want to save and restore a automatic navigation (e.g. save before Power OFF and restore after power ON): <div class="fragment"><pre class="fragment">power_off()
{
   setting_field.navauto_mode = <a class="code" href="a00039.html#76dfee75e1f6d2304bffd0c5cda95939" title="This function returns the directory limitation of the file list.">navauto_getmode</a>(); <span class="comment">// Get explorer mode</span>
   setting_field.navauto_rand = <a class="code" href="a00039.html#9249d84f3a2c0a33f6c900432b520acc" title="This function returns the random state used.">navauto_getrand</a>(); <span class="comment">// Get random mode</span>
   setting_field.navauto_pos  = <a class="code" href="a00039.html#0a611e9ea74f3f53cd26e6db4460dbb5" title="This function closes the file list.">navauto_close</a>();   <span class="comment">// Get current dir level         or playlist position</span>
   setting_field.nav_index    = <a class="code" href="a00047.html#47882923fca657fb23001d23b6b5369d" title="This function returns a small index on the selected file.">nav_getindex</a>();    <span class="comment">// Get current position in disk  or playlist file index</span>

   setting_save();
}

power_on()
{
   _MEM_TYPE_SLOW_   U8    ext_filemusic[]    = <span class="stringliteral">"mp3,mp2"</span>;
   setting_load();
   
   <span class="comment">// Restore navigation configuration</span>
   <a class="code" href="a00039.html#226299cc74eecb96d9af16077b8e769f" title="This function initializes the file extension filter used to create the file list...">navauto_init</a>( ext_filemusic );
   <a class="code" href="a00039.html#cac0f26a59241dec8b77d05353091b9c" title="This function sets the directory limitation of the file list.">navauto_setmode</a>( setting_field.navauto_mode );
   <a class="code" href="a00039.html#b199f759f8a128b99c5efaeeddc7699e" title="This function changes the random state.">navauto_setrand</a>( setting_field.navauto_rand );
  
   <span class="comment">// Restore navigation position</span>
   <a class="code" href="a00047.html#7fac26539a62daf547b5eb159f6a43d4" title="This function selects the navigation to use.">nav_select</a>(0)  
   <span class="comment">// Go to last position in disk or go to paly list file</span>
   <a class="code" href="a00047.html#503f8d42be2b70cb554589ac7974ed78" title="This function selects a file in the navigator via a file index.">nav_gotoindex</a>( &amp;setting_field.nav_index );
   <span class="comment">// Restore navigation with the last directory level or last playlist position</span>
   if( !<a class="code" href="a00039.html#6d888c44ab0f614f283b09def5de12dd" title="This function opens a file list at the current position in navigator.">navauto_open</a>( <a class="code" href="a00047.html#4a3e65b107c26de2f7ff4fb1d2a854e3" title="This function checks the extension of selected file.">nav_file_checkext</a>(ext_playlist) , setting_field.navauto_pos ))
      return FALSE;
}
</pre></div> 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
</table>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Dec 21 18:30:26 2009 for AVR32 - FAT Services by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
